(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65685,       1866]
NotebookOptionsPosition[     61326,       1787]
NotebookOutlinePosition[     62007,       1810]
CellTagsIndexPosition[     61964,       1807]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"ParentDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[1]:=",ExpressionUUID->"a0881841-6297-42bf-b15a-dc9b1006819b"],

Cell[CellGroupData[{

Cell["Plotting", "Section",ExpressionUUID->"016bd226-2cf2-4b93-9745-0d1876fcdb46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"col", "=", 
   RowBox[{"{", 
    RowBox[{"LightBlue", ",", "Yellow", ",", "Orange", ",", "Red", ",", 
     RowBox[{"Darker", "[", "Red", "]"}], ",", "Black"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Color", "[", "norm_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"NumberQ", "[", "norm", "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"norm", "==", "0"}], ",", "White", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{"col", ",", 
         RowBox[{"N", "@", 
          FractionBox["1", 
           RowBox[{"Abs", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", "norm", "]"}], "-", "1"}], ")"}], 
            "]"}]]}]}], "]"}]}], "]"}], ",", "LightGreen"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Color2D", "[", "val_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"NumberQ", "[", "val", "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"val", "==", "0"}], ",", "White", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{"col", ",", 
         RowBox[{"N", "@", 
          FractionBox["1", 
           RowBox[{"Abs", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", "val", "]"}], "-", "1"}], ")"}], 
            "]"}]]}]}], "]"}]}], "]"}], ",", "LightGreen"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Transparency", "[", "value_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"value", "==", "0"}], ",", "0", ",", 
     RowBox[{"(", 
      FractionBox["1", 
       RowBox[{"Abs", "[", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log10", "[", "value", "]"}], "-", "1"}], ")"}], "3"], 
        "]"}]], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Transparency2D", "[", "value_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"value", "==", "0"}], ",", "0", ",", 
      RowBox[{"(", 
       FractionBox["5", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"Log10", "[", "value", "]"}], "-", "1"}], "]"}]], ")"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Color", "[", "#", "]"}], ")"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"N", "@", 
      RowBox[{"Subdivide", "[", "34", "]"}]}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Color2D", "[", "#", "]"}], ")"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"N", "@", 
      RowBox[{"Subdivide", "[", "34", "]"}]}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Transparency", "[", "#", "]"}], ")"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"N", "@", 
      RowBox[{"Subdivide", "[", "34", "]"}]}], ")"}]}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[25]:=",ExpressionUUID->"810dc8be-1b79-4ad0-bc77-be8bac84b404"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GRID", "[", 
    RowBox[{"data_", ",", "opts__"}], "]"}], ":=", 
   RowBox[{"Grid", "[", 
    RowBox[{"data", ",", "opts", ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"ImageSizeMultipliers", "->", "1"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prob1D", "[", 
    RowBox[{"data_", ",", "rng_", ",", 
     RowBox[{"norm_", ":", "None"}], ",", "opts___"}], "]"}], ":=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"data", ",", "opts", ",", 
     RowBox[{"DataRange", "\[Rule]", "rng"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Log10", "@", "norm"}], ",", "0.01"}], "]"}], ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"0.95", ",", "0.95"}], "}"}], "]"}], ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{
       RowBox[{"HoldForm", "@", 
        RowBox[{"Abs", "[", "\[Psi]", "]"}]}], "^", "2"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Phase1D", "[", 
    RowBox[{"data_", ",", "rng_", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"data", ",", "opts", ",", 
     RowBox[{"DataRange", "\[Rule]", "rng"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"HoldForm", "@", 
       RowBox[{"Arg", "[", "\[Psi]", "]"}]}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "\[Pi]"}], ",", 
              RowBox[{"-", "\[Pi]"}], ",", "0.1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", "0.1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0.1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Pi]", "/", "2"}], ",", 
              RowBox[{"\[Pi]", "/", "2"}], ",", "0.1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Pi]", ",", "\[Pi]", ",", "0.1"}], "}"}]}], "}"}], ",",
           "None"}], "}"}], ",", "Automatic"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prob2D", "[", 
    RowBox[{"data_", ",", "rng_", ",", 
     RowBox[{"norm_", ":", "None"}], ",", "opts___"}], "]"}], ":=", 
   RowBox[{"ListDensityPlot", "[", 
    RowBox[{"data", ",", "opts", ",", 
     RowBox[{"DataRange", "\[Rule]", "rng"}], ",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Log10", "@", "norm"}], ",", "0.01"}], "]"}], ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"0.95", ",", "0.95"}], "}"}], "]"}], ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Opacity", " ", "[", 
         RowBox[{"(*", 
          RowBox[{"Transparency2D", "["}], "*)"}], 
         RowBox[{"#", ",", 
          RowBox[{"Color", "[", "norm", "]"}]}], "]"}], "&"}], ")"}]}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "True"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"OpacityFunction", "\[Rule]", "Transparency"}], ",", 
       RowBox[{"OpacityFunctionScaling", "\[Rule]", "True"}], ","}], "*)"}], 
     RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "0"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Phase2D", "[", 
     RowBox[{"data_", ",", "rng_", ",", "opts___"}], "]"}], ":=", 
    RowBox[{"ListDensityPlot", "[", 
     RowBox[{"data", ",", "opts", ",", 
      RowBox[{"DataRange", "\[Rule]", "rng"}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", "Hue"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"3", "D", " ", "plots"}], ",", " ", 
    RowBox[{"colors", ":", " ", 
     RowBox[{
      RowBox[{"indicate", " ", "total", " ", "norm"}], "-", " ", 
      "transparency"}], ":", " ", 
     RowBox[{"local", " ", "values"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prob3D", "[", 
    RowBox[{"data_", ",", "rng_", ",", 
     RowBox[{"norm_", ":", "None"}], ",", "opts___"}], "]"}], ":=", 
   RowBox[{"ListDensityPlot3D", "[", 
    RowBox[{"data", ",", "opts", ",", "\[IndentingNewLine]", 
     RowBox[{"DataRange", "\[Rule]", "rng"}], ",", "\[IndentingNewLine]", 
     RowBox[{"BoxStyle", "\[Rule]", 
      RowBox[{"{", "LightGray", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"norm", "==", "0.0"}], ",", "\"\<-\[Infinity]\>\"", ",", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"Log10", "@", "norm"}], ",", "0.01"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"0.95", ",", "0.95"}], "}"}], "]"}], ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Color", "[", "norm", "]"}], "&"}], ")"}]}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"OpacityFunction", "\[Rule]", "Transparency"}], ",", 
     RowBox[{"OpacityFunctionScaling", "\[Rule]", "True"}], ",", 
     RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Phase3D", "[", 
    RowBox[{"data_", ",", "rng_", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"ListDensityPlot3D", "[", 
    RowBox[{"data", ",", "opts", ",", 
     RowBox[{"DataRange", "\[Rule]", "rng"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
     RowBox[{"RegionFunction", "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "^", "2"}], "+", 
          RowBox[{"y", "^", "2"}], "+", 
          RowBox[{"z", "^", "2"}]}], "\[LessEqual]", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Last", "@", "rng"}], ")"}], "2"], "/", 
          SqrtBox["2"]}]}]}], "]"}]}], ",", 
     RowBox[{"OpacityFunction", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{"f", ",", "0.05"}], "]"}]}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "Hue"}]}], "]"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellLabel->"In[7]:=",ExpressionUUID->"39a6eb59-13c4-4f58-93af-1349ad615d52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"BarLegend", "[", 
      RowBox[{"Automatic", ",", 
       RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"10", ",", 
          RowBox[{"1.04", "size"}]}], "}"}]}], ",", 
       RowBox[{"LegendMargins", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "15"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "0"}], "}"}]}], "}"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"OpacityFunction", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"f", ",", "f"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"BarLegend", "[", 
      RowBox[{"Automatic", ",", 
       RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}]}], 
      RowBox[{"(*", 
       RowBox[{",", 
        RowBox[{"LegendMarkerSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"10", ",", 
           RowBox[{"1.04", "size"}]}], "}"}]}], ",", 
        RowBox[{"LegendMargins", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "15"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", 
             RowBox[{"If", "[", 
              RowBox[{"top", ",", "35", ",", "0"}], "]"}]}], "}"}]}], 
          "}"}]}]}], "*)"}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"All", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"All", ",", "All"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"BarLegend", "[", 
     RowBox[{"Automatic", ",", 
      RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}], ",", 
      RowBox[{"LegendMarkerSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"10", ",", 
         RowBox[{"1.04", "size"}]}], "}"}]}], ",", 
      RowBox[{"LegendMargins", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "15"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "0"}], "}"}]}], "}"}]}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"BarLegend", "[", 
      RowBox[{"Automatic", ",", 
       RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"10", ",", 
          RowBox[{"1.04", "size"}]}], "}"}]}], ",", 
       RowBox[{"LegendMargins", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "15"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "0"}], "}"}]}], "}"}]}]}], "]"}]}], ","}], 
   "*)"}]}]], "Input",ExpressionUUID->"56ab926c-e22f-4462-8011-7e86b3262d23"],

Cell[CellGroupData[{

Cell["Binary", "Subsection",
 CellChangeTimes->{{3.829712288577067*^9, 
  3.829712289286044*^9}},ExpressionUUID->"7a786fbd-35f8-4582-b3a7-\
249cb7b705c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DoubleQ", "[", "size_", "]"}], ":=", 
   RowBox[{"size", "\[Equal]", "8"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReadBinaryWFHeader", "[", "st_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "rep", ",", "unnorm", ",", "initsubtr", ",", "size", ",", 
       "ns", ",", "dxs", ",", "bounded"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dim", ",", "rep"}], "}"}], "=", 
       RowBox[{"BinaryReadList", "[", 
        RowBox[{"st", ",", " ", "\"\<UnsignedInteger8\>\"", ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"unnorm", ",", "initsubtr"}], "}"}], "=", 
       RowBox[{"BinaryReadList", "[", 
        RowBox[{"st", ",", " ", "\"\<Byte\>\"", ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"size", "=", 
       RowBox[{"First", "@", 
        RowBox[{"BinaryReadList", "[", 
         RowBox[{"st", ",", " ", "\"\<Integer32\>\"", ",", "1"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ns", "=", 
       RowBox[{"BinaryReadList", "[", 
        RowBox[{"st", ",", " ", "\"\<Integer64\>\"", ",", "dim"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dxs", "=", 
       RowBox[{"BinaryReadList", "[", 
        RowBox[{"st", ",", " ", "\"\<Real64\>\"", ",", "dim"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bounded", "=", 
       RowBox[{"BinaryReadList", "[", 
        RowBox[{"st", ",", " ", "\"\<Byte\>\"", ",", "dim"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dim", ",", "rep"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"unnorm", ",", "initsubtr"}], "}"}], ",", "size", ",", "ns", 
        ",", "dxs", ",", "bounded"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReadBinaryWF", "[", 
    RowBox[{"st_", ",", "dim_", ",", "n_", ",", "size_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"typesize", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DoubleQ", "[", "size", "]"}], ",", "\"\<Real64\>\"", ",", 
         "\"\<Complex128\>\""}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"BinaryReadList", "[", 
           RowBox[{"st", ",", " ", "typesize", ",", 
            RowBox[{"n", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ",", "##"}], "]"}], 
        "&"}], ",", 
       RowBox[{"Most", "[", "n", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportBinaryAndPlot", "[", 
    RowBox[{"file_", ",", 
     RowBox[{"collapse_", ":", "False"}], ",", 
     RowBox[{"scaleF_", ":", "Identity"}], ",", "opts___"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "rep", ",", "unnorm", ",", "initWfSubtr", ",", "size", ",", 
       "ns", ",", "dxs", ",", "lmaxs", ",", "st", ",", "\[IndentingNewLine]", 
       "norm", ",", "dat", ",", "base", ",", "opt", ",", "rng", ",", "vLabel",
        ",", "\[Psi]", ",", "dV", ",", "bounded"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"base", "=", 
       RowBox[{"FileNameTake", "[", "file", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "read", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"st", "=", 
       RowBox[{"OpenRead", "[", 
        RowBox[{"file", ",", 
         RowBox[{"BinaryFormat", "\[Rule]", "True"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"dim", ",", "rep"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"unnorm", ",", "initWfSubtr"}], "}"}], ",", "size", ",", 
         "ns", ",", "dxs", ",", "bounded"}], "}"}], "=", 
       RowBox[{"ReadBinaryWFHeader", "[", "st", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"ReadBinaryWF", "[", 
        RowBox[{"st", ",", "dim", ",", "ns", ",", "size"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "file", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"make", " ", "range"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"lmaxs", "=", 
       RowBox[{"Times", "@@", 
        RowBox[{"{", 
         RowBox[{"dxs", " ", ",", 
          RowBox[{"(", 
           RowBox[{"ns", "-", "1"}], ")"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rng", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "lmaxs"}], "/", "2.0"}], ",", 
          RowBox[{"lmaxs", "/", "2.0"}]}], "}"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "label", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vLabel", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Latin Modern Roman\>\""}], 
           ",", "14"}], "]"}], "&"}], "/@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DoubleQ", "[", "size", "]"}], ",", 
          SuperscriptBox[
           RowBox[{
           "\[LeftBracketingBar]", "\[Psi]", "\[RightBracketingBar]"}], "2"], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Abs", "[", "\[Psi]", "]"}], ",", 
            RowBox[{"Arg", "[", "\[Psi]", "]"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"collapse", " ", "if", " ", "req"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"If", "[", 
        RowBox[{"collapse", ",", 
         RowBox[{
          RowBox[{"Abs", "[", "dat", "]"}], "^", "2"}], ",", "dat"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"normalize", " ", "if", " ", "req"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"dV", "=", 
         RowBox[{"Times", "@@", "dxs"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dV", "=", 
       RowBox[{"Times", "@@", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", " ", "/", 
            RowBox[{"(", 
             RowBox[{"#2", "^", "#3"}], ")"}]}], "&"}], ",", 
          RowBox[{"{", " ", 
           RowBox[{"dxs", ",", "ns", ",", 
            RowBox[{"1", "-", "bounded"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{"dV", ",", "\"\<dV\>\""}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"unnorm", "==", "1"}], ",", 
         RowBox[{"dat", "*", "dV"}], ",", "dat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"norm", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"dat", ",", "\[Infinity]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{"base", ",", "\"\<base\>\""}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{"bounded", ",", "\"\<bounded\>\""}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"scaleF", "@", "dat"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"dim", ",", "\[IndentingNewLine]", "1", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DoubleQ", "[", "size", "]"}], "||", " ", "collapse"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Prob1D", "[", 
           RowBox[{"dat", ",", "rng", ",", "opts"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GRID", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Prob1D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "dat", "]"}], "^", "2"}], ",", "rng", 
                ",", "250", ",", 
                RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}], ",", 
              RowBox[{"Phase1D", "[", 
               RowBox[{
                RowBox[{"Arg", "@", "dat"}], ",", "rng", ",", "250", ",", 
                RowBox[{"FrameStyle", "\[Rule]", "Red"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], "}"}], 
            "}"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", "2", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DoubleQ", "[", "size", "]"}], "||", " ", "collapse"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Prob2D", "[", 
           RowBox[{"dat", ",", "rng", ",", "norm", ",", "opts"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GRID", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Prob2D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "dat", "]"}], "^", "2"}], ",", "rng", 
                ",", "250", ",", "True"}], "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Phase2D", "[", 
               RowBox[{
                RowBox[{"Arg", "@", "dat"}], ",", "rng", ",", "250"}], "]"}], 
              "}"}]}], "}"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", "3",
         ",", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"DoubleQ", "[", "size", "]"}], "||", " ", "collapse"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Prob3D", "[", 
           RowBox[{"dat", ",", "rng", ",", "norm", ",", "opts"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GRID", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Prob3D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "dat", "]"}], "^", "2"}], ",", "rng", 
                ",", "250"}], "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Phase3D", "[", 
               RowBox[{
                RowBox[{"Arg", "@", "dat"}], ",", "rng", ",", "250"}], "]"}], 
              "}"}]}], "}"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalcWFNorm", "[", 
    RowBox[{"file_", ",", 
     RowBox[{"collapse_", ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "rep", ",", "unnorm", ",", "initWfSubtr", ",", "size", ",", 
       "ns", ",", "dxs", ",", "lmaxs", ",", "st", ",", "\[IndentingNewLine]", 
       "norm", ",", "dat", ",", "base", ",", "opt", ",", "rng", ",", "vLabel",
        ",", "\[Psi]", ",", "dV", ",", "bounded"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "read", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"st", "=", 
       RowBox[{"OpenRead", "[", 
        RowBox[{"file", ",", 
         RowBox[{"BinaryFormat", "\[Rule]", "True"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"dim", ",", "rep"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"unnorm", ",", "initWfSubtr"}], "}"}], ",", "size", ",", 
         "ns", ",", "dxs", ",", "bounded"}], "}"}], "=", 
       RowBox[{"ReadBinaryWFHeader", "[", "st", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"ReadBinaryWF", "[", 
        RowBox[{"st", ",", "dim", ",", "ns", ",", "size"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "file", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"If", "[", 
        RowBox[{"collapse", ",", 
         RowBox[{
          RowBox[{"Abs", "[", "dat", "]"}], "^", "2"}], ",", "dat"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"dV", "=", 
       RowBox[{"Times", "@@", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", " ", "/", 
            RowBox[{"(", 
             RowBox[{"#2", "^", "#3"}], ")"}]}], "&"}], ",", 
          RowBox[{"{", " ", 
           RowBox[{"dxs", ",", "ns", ",", 
            RowBox[{"1", "-", "bounded"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"unnorm", "==", "1"}], ",", 
         RowBox[{"dat", "*", "dV"}], ",", "dat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"norm", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"dat", ",", "\[Infinity]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "norm"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[14]:=",ExpressionUUID->"37b93b60-b27c-45e1-9cb2-a936bebf0af9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nam", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<N\>\"", ",", "\"\<\!\(\*SubscriptBox[\(S\), \(X\)]\)\>\"", ",", " ", 
     "\"\<\!\(\*SubscriptBox[\(S\), \(Y\)]\)\>\"", ",", " ", 
     "\"\<\!\(\*SubscriptBox[\(S\), \(Z\)]\)\>\"", ",", " ", 
     "\"\<\!\(\*SubscriptBox[\(D\), \(XY\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(D\), \(XZ\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(D\), \(YZ\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(D\), \(XYZ\)]\)\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dir", "=", "\"\<template/Results/\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"RemoveComments", ":=", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", "#", "]"}], ",", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"StringTrim", "@", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"RegularExpression", "[", "\"\<#.*\>\"", "]"}], 
             "\[Rule]", "\"\<\>\""}]}], "]"}]}]}], ",", 
        RowBox[{"Identity", "[", "#", "]"}]}], "]"}], "&"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DisplayINI", ":=", 
     RowBox[{
      RowBox[{"Dataset", "@", 
       RowBox[{"Map", "[", 
        RowBox[{"RemoveComments", ",", 
         RowBox[{"Import", "[", 
          RowBox[{"First", "@", 
           RowBox[{"FileNames", "[", 
            RowBox[{"#", "<>", "\"\<../*.ini\>\""}], "]"}]}], "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}]}], "&"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dx", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"DisplayINI", "[", "dir", "]"}], "[", 
       RowBox[{"\"\<DEFAULT\>\"", ",", "\"\<L\>\""}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"DisplayINI", "[", "dir", "]"}], "[", 
         RowBox[{"\"\<DEFAULT\>\"", ",", "\"\<n\>\""}], "]"}], "-", "1"}], 
       ")"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Echo", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"N", "@", "2"}], 
       RowBox[{"\[Pi]", "/", 
        RowBox[{
         RowBox[{"DisplayINI", "[", "dir", "]"}], "[", 
         RowBox[{"\"\<DEFAULT\>\"", ",", "\"\<L\>\""}], "]"}]}]}], ",", 
      "dp"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"n", "=", 
     RowBox[{
      RowBox[{"DisplayINI", "[", "dir", "]"}], "[", 
      RowBox[{"\"\<DEFAULT\>\"", ",", "\"\<n\>\""}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Echo", "[", 
     RowBox[{
      RowBox[{"N", "@", "dx"}], ",", "\"\<dx\>\""}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Echo", "[", 
     RowBox[{"n", ",", "\"\<n\>\""}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Echo", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"N", "@", "\[Pi]"}], "/", "dx"}], ",", 
      SubscriptBox["p", "max"]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Id", ":=", 
   RowBox[{
    RowBox[{"ToExpression", "@", 
     RowBox[{"StringTake", "[", 
      RowBox[{"#", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"viewpoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cplot", ":=", 
   RowBox[{
    RowBox[{"ImportBinaryAndPlot", "[", 
     RowBox[{"#", ",", "True", ",", "Identity", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ClipPlanes", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "2"}], "}"}], "}"}]}], ",", 
        RowBox[{"OpacityFunction", "\[Rule]", "None"}], ","}], "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "->", "Full"}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"InterpolationOrder", "->", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ViewMatrix", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"s", ".", "rx", ".", "rz"}], "]"}], ",", "p"}], "}"}]}], 
        ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"viewpoints", "[", 
          RowBox[{"[", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Id", "@", "#"}], ">", "3"}], ",", "1", ",", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"Id", "@", "#"}], ",", "3", ",", "1"}], "]"}]}], "]"}],
            "]"}], "]"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ViewPoint", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Top", ",", "Left", ",", "Front"}], "}"}], "[", 
           RowBox[{"[", 
            RowBox[{"Id", "@", "#"}], "]"}], "]"}], ")"}]}], ","}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ViewVector", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2.9", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Id", "@", "#"}], ">", "3"}], ",", 
              RowBox[{"RotateRight", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "30", ",", "0"}], "}"}], ",", 
                RowBox[{"Id", "@", "#"}]}], "]"}], ",", 
              RowBox[{"RotateLeft", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"30", ",", "0.0", ",", "0.0"}], "}"}], ",", 
                RowBox[{"Id", "@", "#"}]}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0.0"}], "}"}]}], "}"}]}], ","}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"Z", ",", "Y", ",", "X"}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "->", 
       RowBox[{"nam", "[", 
        RowBox[{"[", 
         RowBox[{"1", "+", 
          RowBox[{"Id", "@", "#"}]}], "]"}], "]"}]}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", ":=", 
   RowBox[{
    RowBox[{"ToExpression", "@", 
     RowBox[{"StringExtract", "[", 
      RowBox[{"#", ",", 
       RowBox[{"\"\<_\>\"", "->", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"\"\<i\>\"", "->", "1"}]}], "]"}]}], "&"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellLabel->"In[19]:=",ExpressionUUID->"419c0c2c-516b-43e5-aae0-eaacbef41cfd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "refresh", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sorted", ":=", 
     RowBox[{
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"FileNames", "[", 
           RowBox[{"dir", "<>", "#"}], "]"}], ",", "order"}], "]"}], ",", 
        "order"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "during", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"before", "=", 
     RowBox[{"sorted", "@", "\"\<RE3e3d*_bef_xyz.psib*\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"selected", "=", 
     RowBox[{"sorted", "@", "\"\<RE3e3d*_*i_xyz.psib*\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"after", "=", 
     RowBox[{"sorted", "@", "\"\<RE3e3d*_aft_xyz.psib*\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"selected", "=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"before", ",", "selected", ",", "after"}], "]"}], "[", 
     RowBox[{"[", "All", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"cplot", "/@", "#"}], ")"}], "&"}], "/@", "selected"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "]"}]}]}]], "Input",
 CellLabel->"In[50]:=",
 CellID->1812452921,ExpressionUUID->"009e8f5c-fca5-4f17-ad70-bd3262e7ee2f"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[54]=",ExpressionUUID->"3803403f-ac8c-4034-a762-6e511ad33e72"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"files", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"dir", "<>", "\"\</*.psi*\>\""}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[59]:=",ExpressionUUID->"28c02a53-9757-48dd-94cd-a69e94315411"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"st", "=", 
   RowBox[{"OpenRead", "[", 
    RowBox[{
     RowBox[{"First", "@", 
      RowBox[{"Select", "[", 
       RowBox[{"files", ",", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", "\"\<im\>\""}], "]"}], "&"}]}], "]"}]}], ",", 
     RowBox[{"BinaryFormat", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"dims", ",", "rep"}], "}"}], "=", 
  RowBox[{"BinaryReadList", "[", 
   RowBox[{"st", ",", " ", "\"\<UnsignedInteger8\>\"", ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"unnorm", ",", "initsubtr"}], "}"}], "=", 
  RowBox[{"BinaryReadList", "[", 
   RowBox[{"st", ",", " ", "\"\<Byte\>\"", ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"size", "=", 
  RowBox[{"BinaryRead", "[", 
   RowBox[{"st", ",", " ", "\"\<Integer32\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ns", "=", 
  RowBox[{"BinaryReadList", "[", 
   RowBox[{"st", ",", " ", "\"\<Integer64\>\"", ",", "dims"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxs", "=", 
   RowBox[{"BinaryReadList", "[", 
    RowBox[{"st", ",", " ", "\"\<Real64\>\"", ",", "dims"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"BinaryReadList", "[", 
    RowBox[{"st", ",", " ", "\"\<Complex128\>\"", ",", "10"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"typesize", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"DoubleQ", "[", "size", "]"}], ",", "\"\<Real64\>\"", ",", 
     "\"\<Complex128\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"data", "=", 
  RowBox[{"Abs", "@", 
   RowBox[{"Apply", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BinaryReadList", "[", 
         RowBox[{"st", ",", " ", "typesize", ",", 
          RowBox[{"ns", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ",", "##"}], "]"}], 
      "&"}], ",", 
     RowBox[{"Most", "[", "ns", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListDensityPlot3D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "#", "]"}], "^", "2"}], "&"}], "/@", "data"}], 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"cplot", "[", 
    RowBox[{
     RowBox[{"files", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "True"}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dim", ",", "rep", ",", "unnorm", ",", "initWfSubtr", ",", "size"}], 
        "}"}], ",", "ns", ",", "dxs"}], "}"}], "=", 
     RowBox[{"ReadBinaryWFHeader", "[", "st", "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Close", "[", "st", "]"}]}], "Input",
 CellLabel->
  "In[271]:=",ExpressionUUID->"63f520a6-8fe0-4b85-8ea2-b8fa863e9502"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "1"}], "}"}]], "Output",
 CellLabel->
  "Out[272]=",ExpressionUUID->"8dc061ac-61d6-49ac-bdc5-50c1c8805383"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0"}], "}"}]], "Output",
 CellLabel->
  "Out[273]=",ExpressionUUID->"66e4d070-41c8-4831-aea5-88c17c380070"],

Cell[BoxData["16"], "Output",
 CellLabel->
  "Out[274]=",ExpressionUUID->"9f65e875-d9f7-4a59-a07b-1ebee1163042"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"32", ",", "32", ",", "32"}], "}"}]], "Output",
 CellLabel->
  "Out[275]=",ExpressionUUID->"046de108-7246-4b38-acef-218c844e4fc0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.5`", ",", "1.5`", ",", "1.5`"}], "}"}]], "Output",
 CellLabel->
  "Out[276]=",ExpressionUUID->"e8b2bd28-79c3-4857-b566-24256ed81d22"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dir", "=", "\"\<template/Results/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"dir", "<>", "\"\</*.psi*\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati0_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati1_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati50_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati150_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati200_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati1000_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<im\>\""}], "]"}], "&"}]}], "]"}]}]}], "Input",Exp\
ressionUUID->"12e8e1d4-6311-42e3-8d06-9e766a03fd87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dir", "=", "\"\<template-3e/Results/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"dir", "<>", "\"\</*.psi*\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<at1_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<at50_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<at100_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<at150_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"Select", "[", 
    RowBox[{"files", ",", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{"#", ",", "\"\<at200_\>\""}], "]"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"files", ",", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<at250_\>\""}], "]"}], "&"}]}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"Select", "[", 
    RowBox[{"files", ",", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{"#", ",", "\"\<at300_\>\""}], "]"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"files", ",", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<at350_\>\""}], "]"}], "&"}]}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<final\>\""}], "]"}], "&"}]}], "]"}]}]}], "Input",\
ExpressionUUID->"21f81ee8-e107-4538-9271-f04a705c31ed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"FileNames", "[", "\"\</Users/ranza/Downloads/*.psi*\>\"", "]"}], 
   ",", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"#", ",", "\"\<at100_\>\""}], "]"}], "&"}]}], "]"}]], "Input",
 CellLabel->
  "In[185]:=",ExpressionUUID->"30ab537e-90ec-4bbd-a7db-a298dab4fd26"],

Cell[BoxData[
 RowBox[{"{", \
"\<\"/Users/ranza/Downloads/at100_0ELECeDIMd__aft_xyz.psib1\"\>", 
  "}"}]], "Output",
 CellLabel->
  "Out[185]=",ExpressionUUID->"5428ba5d-8bfe-400f-aba9-1a8d1a207ba1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CalcWFNorm", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", "%"}]], "Input",
 CellLabel->
  "In[184]:=",ExpressionUUID->"2a3f3b0f-97fa-4a46-ab25-45ab315ccf0f"],

Cell[BoxData[
 RowBox[{"{", "0.12159309900991877`", "}"}]], "Output",
 CellLabel->
  "Out[184]=",ExpressionUUID->"5fa829dc-e5b3-439c-b6d7-d44fa0a742f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"cplot", "[", "#", "]"}], "]"}], "&"}], "/@", "%"}]], "Input",
 CellLabel->
  "In[186]:=",ExpressionUUID->"1deb7aef-9dea-4857-9518-8ab9582b9e62"],

Cell[BoxData[
 RowBox[{"{", "Null", "}"}]], "Output",
 CellLabel->
  "Out[186]=",ExpressionUUID->"27fbc24e-f08f-4a84-9ab0-92f62fca3690"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib1\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib2\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib3\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib4\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib5\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib6\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib7\>\"", 
  "]"}]}], "Input",ExpressionUUID->"3232165b-aa2e-4854-b00d-5c0e40ebd4c4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<at1_\>\""}], "]"}], "&"}]}], "]"}]}], ")"}],
      ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<at50_\>\""}], "]"}], "&"}]}], "]"}]}], 
      ")"}], ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<at100_\>\""}], "]"}], "&"}]}], "]"}]}], 
      ")"}], ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<at150_\>\""}], "]"}], "&"}]}], "]"}]}], 
      ")"}], ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<at200_\>\""}], "]"}], "&"}]}], "]"}]}], 
      ")"}], ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<final\>\""}], "]"}], "&"}]}], "]"}]}], 
      ")"}], ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], ";"}]}], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"fbb28ead-b819-44da-b59a-6b41088be28f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "0.9999999997444639`", ",", "7.384716886400857`*^-11", ",", 
    "7.384716886407496`*^-11", ",", "7.384716886409811`*^-11", ",", 
    "1.0925905394229457`*^-14", ",", "1.0925905394216863`*^-14", ",", 
    "1.5775653229828753`*^-14", ",", "7.384263048730993`*^-25"}], 
   "}"}]}]], "Echo",ExpressionUUID->"e0d8a200-22a6-4a9b-9ec9-ef19e2d191c9"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "6.791237320407708`*^-11", ",", "4.455200825722581`*^-7", ",", 
    "4.45520082572257`*^-7", ",", "4.4552008257226405`*^-7", ",", 
    "0.0011067344479767666`", ",", "0.0011067344479767669`", ",", 
    "0.0007939710627467297`", ",", "1.0427908974409374`"}], "}"}]}]], "Echo",E\
xpressionUUID->"f7a80985-f776-486b-a5d6-70c29ef5b1d4"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "0.522255609013465`", ",", "0.13149073672585027`", ",", 
    "0.13149073672585032`", ",", "0.1314907367258503`", ",", 
    "0.014190168131023407`", ",", "0.014190168131023409`", ",", 
    "0.01419016813102341`", ",", "0.00170842670807647`"}], "}"}]}]], "Echo",Ex\
pressionUUID->"546f37b8-7b7a-413f-81a9-ac044ee08bdb"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "0.012925085733704652`", ",", "0.0511923415202839`", ",", 
    "0.051192341520283915`", ",", "0.051192341520283874`", ",", 
    "0.03381785455120159`", ",", "0.03381785455120148`", ",", 
    "0.03381785455120153`", ",", "0.03517340769856293`"}], "}"}]}]], "Echo",Ex\
pressionUUID->"e4c94ef5-6f2b-4e39-8a80-ca78aa9c8ad1"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "0.00013784611557035264`", ",", "0.001063264569461637`", ",", 
    "0.0010632645694616386`", ",", "0.0010632645694616382`", ",", 
    "0.006777063370829729`", ",", "0.006777063370829749`", ",", 
    "0.006777063370829736`", ",", "0.14232089653921048`"}], "}"}]}]], "Echo",E\
xpressionUUID->"2ed4f811-7dea-4673-bb8b-77a80660bfd2"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "5.753862022456611`*^-8", ",", "5.983781622371874`*^-6", ",", 
    "5.983781622371908`*^-6", ",", "5.983781622371918`*^-6", ",", 
    "0.00033338471536406913`", ",", "0.0003333847153640686`", ",", 
    "0.00033338471536406913`", ",", "0.15347819615227654`"}], "}"}]}]], "Echo",\
ExpressionUUID->"ce49d6cc-6447-4b9b-bcbb-823f22159ec3"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nam", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<N\>\"", ",", "\"\<\!\(\*SubscriptBox[\(S\), \(X\)]\)\>\"", ",", " ", 
     "\"\<\!\(\*SubscriptBox[\(S\), \(Y\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(D\), \(XY\)]\)\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cplot", ":=", 
   RowBox[{
    RowBox[{"ImportBinaryAndPlot", "[", 
     RowBox[{"#", ",", "False", ",", "Identity", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ClipPlanes", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "2"}], "}"}], "}"}]}], ",", 
        RowBox[{"OpacityFunction", "\[Rule]", "None"}], ","}], "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "->", "Full"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"PlotLegends", "->", "Automatic"}], ","}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", 
        RowBox[{"Y", ",", "X"}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "->", 
       RowBox[{"nam", "[", 
        RowBox[{"[", 
         RowBox[{"1", "+", 
          RowBox[{"ToExpression", "@", 
           RowBox[{"StringTake", "[", 
            RowBox[{"#", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], "]"}]}]}], "]"}], 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", ":=", 
   RowBox[{
    RowBox[{"ToExpression", "@", 
     RowBox[{"StringExtract", "[", 
      RowBox[{"#", ",", 
       RowBox[{"\"\<_\>\"", "->", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"\"\<i\>\"", "->", "1"}]}], "]"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sorted", ":=", 
    RowBox[{
     RowBox[{"SplitBy", "[", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"dir", "<>", "#"}], "]"}], ",", "order"}], "]"}], ",", 
       "order"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "refresh", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"before", "=", 
   RowBox[{"sorted", "@", "\"\<RE2e2d*_bef_xy.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selected", "=", 
   RowBox[{"sorted", "@", "\"\<RE2e2d*_*i_xy.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"after", "=", 
   RowBox[{"sorted", "@", "\"\<RE2e2d*_aft_xy.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selected", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"before", ",", "selected", ",", "after"}], "]"}], "[", 
    RowBox[{"[", "All", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"cplot", "/@", "#"}], ")"}], "&"}], "/@", "selected"}], ",", 
   RowBox[{"Spacings", "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "]"}]}], "Input",ExpressionUUID->"36fd4a1b-4d2b-\
4da4-b502-2b3cdf8c9a90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nam", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<N\>\"", ",", "\"\<\!\(\*SubscriptBox[\(S\), \(X\)]\)\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cplot", ":=", 
   RowBox[{
    RowBox[{"ImportBinaryAndPlot", "[", 
     RowBox[{"#", ",", "False", ",", "Identity", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ClipPlanes", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "2"}], "}"}], "}"}]}], ",", 
        RowBox[{"OpacityFunction", "\[Rule]", "None"}], ","}], "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "->", "Full"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"PlotLegends", "->", "Automatic"}], ","}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", "X", "}"}]}], ",", 
      RowBox[{"PlotLabel", "->", 
       RowBox[{"nam", "[", 
        RowBox[{"[", 
         RowBox[{"1", "+", 
          RowBox[{"ToExpression", "@", 
           RowBox[{"StringTake", "[", 
            RowBox[{"#", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], "]"}]}]}], "]"}], 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", ":=", 
   RowBox[{
    RowBox[{"ToExpression", "@", 
     RowBox[{"StringExtract", "[", 
      RowBox[{"#", ",", 
       RowBox[{"\"\<_\>\"", "->", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"\"\<i\>\"", "->", "1"}]}], "]"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sorted", ":=", 
    RowBox[{
     RowBox[{"SplitBy", "[", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"dir", "<>", "#"}], "]"}], ",", "order"}], "]"}], ",", 
       "order"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "refresh", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"before", "=", 
   RowBox[{"sorted", "@", "\"\<RE1e1d*_bef_x.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selected", "=", 
   RowBox[{"sorted", "@", "\"\<RE1e1d*_*i_x.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"after", "=", 
   RowBox[{"sorted", "@", "\"\<RE1e1d*_aft_x.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selected", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"before", ",", "selected", ",", "after"}], "]"}], "[", 
    RowBox[{"[", "All", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"cplot", "/@", "#"}], ")"}], "&"}], "/@", "selected"}], ",", 
   RowBox[{"Spacings", "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "]"}]}], "Input",ExpressionUUID->"93f602db-65ee-\
4f44-9cf0-219cef12c42e"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1720, 1387},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
Magnification:>0.75 Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "12.3 for Mac OS X x86 (64-bit) (May 11, 2021)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"1b012cc0-25e2-49f4-8daf-e1166430be28"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 272, 6, 36, "Input",ExpressionUUID->"a0881841-6297-42bf-b15a-dc9b1006819b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[855, 30, 82, 0, 51, "Section",ExpressionUUID->"016bd226-2cf2-4b93-9745-0d1876fcdb46"],
Cell[940, 32, 3195, 100, 227, "Input",ExpressionUUID->"810dc8be-1b79-4ad0-bc77-be8bac84b404",
 InitializationCell->True],
Cell[4138, 134, 7847, 203, 327, "Input",ExpressionUUID->"39a6eb59-13c4-4f58-93af-1349ad615d52",
 InitializationCell->True],
Cell[11988, 339, 3372, 92, 121, "Input",ExpressionUUID->"56ab926c-e22f-4462-8011-7e86b3262d23"],
Cell[CellGroupData[{
Cell[15385, 435, 154, 3, 41, "Subsection",ExpressionUUID->"7a786fbd-35f8-4582-b3a7-249cb7b705c9"],
Cell[15542, 440, 13592, 352, 1064, "Input",ExpressionUUID->"37b93b60-b27c-45e1-9cb2-a936bebf0af9",
 InitializationCell->True],
Cell[29137, 794, 7178, 206, 341, "Input",ExpressionUUID->"419c0c2c-516b-43e5-aae0-eaacbef41cfd",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[36340, 1004, 1460, 41, 137, "Input",ExpressionUUID->"009e8f5c-fca5-4f17-ad70-bd3262e7ee2f",
 CellID->1812452921],
Cell[37803, 1047, 124, 2, 27, "Output",ExpressionUUID->"3803403f-ac8c-4034-a762-6e511ad33e72"]
}, Open  ]],
Cell[37942, 1052, 229, 5, 24, "Input",ExpressionUUID->"28c02a53-9757-48dd-94cd-a69e94315411"],
Cell[CellGroupData[{
Cell[38196, 1061, 2966, 88, 217, "Input",ExpressionUUID->"63f520a6-8fe0-4b85-8ea2-b8fa863e9502"],
Cell[41165, 1151, 156, 4, 27, "Output",ExpressionUUID->"8dc061ac-61d6-49ac-bdc5-50c1c8805383"],
Cell[41324, 1157, 156, 4, 27, "Output",ExpressionUUID->"66e4d070-41c8-4831-aea5-88c17c380070"],
Cell[41483, 1163, 112, 2, 27, "Output",ExpressionUUID->"9f65e875-d9f7-4a59-a07b-1ebee1163042"],
Cell[41598, 1167, 169, 4, 27, "Output",ExpressionUUID->"046de108-7246-4b38-acef-218c844e4fc0"],
Cell[41770, 1173, 175, 4, 27, "Output",ExpressionUUID->"e8b2bd28-79c3-4857-b566-24256ed81d22"]
}, Open  ]],
Cell[41960, 1180, 2403, 78, 153, "Input",ExpressionUUID->"12e8e1d4-6311-42e3-8d06-9e766a03fd87"],
Cell[44366, 1260, 2872, 93, 185, "Input",ExpressionUUID->"21f81ee8-e107-4538-9271-f04a705c31ed"],
Cell[CellGroupData[{
Cell[47263, 1357, 344, 9, 25, "Input",ExpressionUUID->"30ab537e-90ec-4bbd-a7db-a298dab4fd26"],
Cell[47610, 1368, 199, 5, 27, "Output",ExpressionUUID->"5428ba5d-8bfe-400f-aba9-1a8d1a207ba1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47846, 1378, 217, 6, 24, "Input",ExpressionUUID->"2a3f3b0f-97fa-4a46-ab25-45ab315ccf0f"],
Cell[48066, 1386, 152, 3, 27, "Output",ExpressionUUID->"5fa829dc-e5b3-439c-b6d7-d44fa0a742f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48255, 1394, 218, 6, 24, "Input",ExpressionUUID->"1deb7aef-9dea-4857-9518-8ab9582b9e62"],
Cell[48476, 1402, 136, 3, 27, "Output",ExpressionUUID->"27fbc24e-f08f-4a84-9ab0-92f62fca3690"]
}, Open  ]],
Cell[48627, 1408, 924, 21, 121, "Input",ExpressionUUID->"3232165b-aa2e-4854-b00d-5c0e40ebd4c4"],
Cell[CellGroupData[{
Cell[49576, 1433, 3054, 96, 105, "Input",ExpressionUUID->"fbb28ead-b819-44da-b59a-6b41088be28f"],
Cell[CellGroupData[{
Cell[52655, 1533, 454, 10, 21, "Echo",ExpressionUUID->"e0d8a200-22a6-4a9b-9ec9-ef19e2d191c9"],
Cell[53112, 1545, 443, 10, 21, "Echo",ExpressionUUID->"f7a80985-f776-486b-a5d6-70c29ef5b1d4"],
Cell[53558, 1557, 428, 10, 19, "Echo",ExpressionUUID->"546f37b8-7b7a-413f-81a9-ac044ee08bdb"],
Cell[53989, 1569, 431, 10, 19, "Echo",ExpressionUUID->"e4c94ef5-6f2b-4e39-8a80-ca78aa9c8ad1"],
Cell[54423, 1581, 440, 10, 19, "Echo",ExpressionUUID->"2ed4f811-7dea-4673-bb8b-77a80660bfd2"],
Cell[54866, 1593, 445, 10, 21, "Echo",ExpressionUUID->"ce49d6cc-6447-4b9b-bcbb-823f22159ec3"]
}, Open  ]]
}, Open  ]],
Cell[55338, 1607, 3056, 89, 201, "Input",ExpressionUUID->"36fd4a1b-4d2b-4da4-b502-2b3cdf8c9a90"],
Cell[58397, 1698, 2901, 85, 201, "Input",ExpressionUUID->"93f602db-65ee-4f44-9cf0-219cef12c42e"]
}, Open  ]]
}, Open  ]]
}
]
*)

