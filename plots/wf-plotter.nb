(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     78385,       2235]
NotebookOptionsPosition[     72285,       2133]
NotebookOutlinePosition[     72988,       2156]
CellTagsIndexPosition[     72945,       2153]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"ParentDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[25]:=",ExpressionUUID->"a0881841-6297-42bf-b15a-dc9b1006819b"],

Cell[CellGroupData[{

Cell["Plotting", "Section",ExpressionUUID->"016bd226-2cf2-4b93-9745-0d1876fcdb46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"col", "=", 
   RowBox[{"{", 
    RowBox[{"LightBlue", ",", "Yellow", ",", "Orange", ",", "Red", ",", 
     RowBox[{"Darker", "[", "Red", "]"}], ",", "Black"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Color", "[", "norm_", "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"NumberQ", "[", "norm", "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"norm", "==", "0"}], ",", "White", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{"col", ",", 
         RowBox[{"N", "@", 
          FractionBox["1", 
           RowBox[{"Abs", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", "norm", "]"}], "-", "1"}], ")"}], 
            "]"}]]}]}], "]"}]}], "]"}], ",", "LightGreen"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Color2D", "[", "val_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"NumberQ", "[", "val", "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"val", "==", "0"}], ",", "White", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{"col", ",", 
         RowBox[{"N", "@", 
          FractionBox["1", 
           RowBox[{"Abs", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", "val", "]"}], "-", "1"}], ")"}], 
            "]"}]]}]}], "]"}]}], "]"}], ",", "LightGreen"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Transparency", "[", "value_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"value", "==", "0"}], ",", "0", ",", 
     RowBox[{"(", 
      FractionBox["1", 
       RowBox[{"Abs", "[", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log10", "[", "value", "]"}], "-", "1"}], ")"}], "3"], 
        "]"}]], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Transparency2D", "[", "value_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"value", "==", "0"}], ",", "0", ",", 
      RowBox[{"(", 
       FractionBox["5", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"Log10", "[", "value", "]"}], "-", "1"}], "]"}]], ")"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Color", "[", "#", "]"}], ")"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"N", "@", 
      RowBox[{"Subdivide", "[", "34", "]"}]}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Color2D", "[", "#", "]"}], ")"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"N", "@", 
      RowBox[{"Subdivide", "[", "34", "]"}]}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Transparency", "[", "#", "]"}], ")"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"N", "@", 
      RowBox[{"Subdivide", "[", "34", "]"}]}], ")"}]}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[2]:=",ExpressionUUID->"810dc8be-1b79-4ad0-bc77-be8bac84b404"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GRID", "[", 
    RowBox[{"data_", ",", "opts__"}], "]"}], ":=", 
   RowBox[{"Grid", "[", 
    RowBox[{"data", ",", "opts", ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"ImageSizeMultipliers", "->", "1"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prob1D", "[", 
    RowBox[{"data_", ",", "rng_", ",", 
     RowBox[{"norm_", ":", "None"}], ",", "opts___"}], "]"}], ":=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"data", ",", "opts", ",", 
     RowBox[{"DataRange", "\[Rule]", "rng"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Log10", "@", "norm"}], ",", "0.01"}], "]"}], ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"0.95", ",", "0.95"}], "}"}], "]"}], ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{
       RowBox[{"HoldForm", "@", 
        RowBox[{"Abs", "[", "\[Psi]", "]"}]}], "^", "2"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Phase1D", "[", 
    RowBox[{"data_", ",", "rng_", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"data", ",", "opts", ",", 
     RowBox[{"DataRange", "\[Rule]", "rng"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"HoldForm", "@", 
       RowBox[{"Arg", "[", "\[Psi]", "]"}]}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "\[Pi]"}], ",", 
              RowBox[{"-", "\[Pi]"}], ",", "0.1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", "0.1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0.1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Pi]", "/", "2"}], ",", 
              RowBox[{"\[Pi]", "/", "2"}], ",", "0.1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Pi]", ",", "\[Pi]", ",", "0.1"}], "}"}]}], "}"}], ",",
           "None"}], "}"}], ",", "Automatic"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prob2D", "[", 
    RowBox[{"data_", ",", "rng_", ",", 
     RowBox[{"norm_", ":", "None"}], ",", "opts___"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"ListDensityPlot", "[", 
    RowBox[{"data", ",", "opts", ",", 
     RowBox[{"DataRange", "\[Rule]", "rng"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Log10", "@", "norm"}], ",", "0.01"}], "]"}], ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"0.95", ",", "0.95"}], "}"}], "]"}], ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Opacity", " ", "[", 
           RowBox[{"(*", 
            RowBox[{"Transparency2D", "["}], "*)"}], 
           RowBox[{"#", ",", 
            RowBox[{"Color", "[", "norm", "]"}]}], "]"}], "&"}], ")"}]}], ",", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "True"}], ","}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"OpacityFunction", "\[Rule]", "Transparency"}], ",", 
       RowBox[{"OpacityFunctionScaling", "\[Rule]", "True"}], ","}], "*)"}], 
     RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "0"}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "*)"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Phase2D", "[", 
     RowBox[{"data_", ",", "rng_", ",", "opts___"}], "]"}], ":=", 
    RowBox[{"ListDensityPlot", "[", 
     RowBox[{"data", ",", "opts", ",", 
      RowBox[{"DataRange", "\[Rule]", "rng"}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", "Hue"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"3", "D", " ", "plots"}], ",", " ", 
    RowBox[{"colors", ":", " ", 
     RowBox[{
      RowBox[{"indicate", " ", "total", " ", "norm"}], "-", " ", 
      "transparency"}], ":", " ", 
     RowBox[{"local", " ", "values"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prob3D", "[", 
    RowBox[{"data_", ",", "rng_", ",", 
     RowBox[{"norm_", ":", "None"}], ",", "opts___"}], "]"}], ":=", 
   RowBox[{"ListDensityPlot3D", "[", 
    RowBox[{"data", ",", "opts", ",", "\[IndentingNewLine]", 
     RowBox[{"DataRange", "\[Rule]", "rng"}], ",", "\[IndentingNewLine]", 
     RowBox[{"BoxStyle", "\[Rule]", 
      RowBox[{"{", "LightGray", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"norm", "==", "0.0"}], ",", "\"\<-\[Infinity]\>\"", ",", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"Log10", "@", "norm"}], ",", "0.01"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"0.95", ",", "0.95"}], "}"}], "]"}], ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Color", "[", "norm", "]"}], "&"}], ")"}]}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"OpacityFunction", "\[Rule]", "Transparency"}], ",", 
     RowBox[{"OpacityFunctionScaling", "\[Rule]", "True"}], ",", 
     RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Phase3D", "[", 
    RowBox[{"data_", ",", "rng_", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"ListDensityPlot3D", "[", 
    RowBox[{"data", ",", "opts", ",", 
     RowBox[{"DataRange", "\[Rule]", "rng"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
     RowBox[{"RegionFunction", "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "^", "2"}], "+", 
          RowBox[{"y", "^", "2"}], "+", 
          RowBox[{"z", "^", "2"}]}], "\[LessEqual]", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Last", "@", "rng"}], ")"}], "2"], "/", 
          SqrtBox["2"]}]}]}], "]"}]}], ",", 
     RowBox[{"OpacityFunction", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{"f", ",", "0.05"}], "]"}]}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "Hue"}]}], "]"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellLabel->"In[7]:=",ExpressionUUID->"39a6eb59-13c4-4f58-93af-1349ad615d52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"BarLegend", "[", 
      RowBox[{"Automatic", ",", 
       RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"10", ",", 
          RowBox[{"1.04", "size"}]}], "}"}]}], ",", 
       RowBox[{"LegendMargins", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "15"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "0"}], "}"}]}], "}"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"OpacityFunction", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"f", ",", "f"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"BarLegend", "[", 
      RowBox[{"Automatic", ",", 
       RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}]}], 
      RowBox[{"(*", 
       RowBox[{",", 
        RowBox[{"LegendMarkerSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"10", ",", 
           RowBox[{"1.04", "size"}]}], "}"}]}], ",", 
        RowBox[{"LegendMargins", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "15"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", 
             RowBox[{"If", "[", 
              RowBox[{"top", ",", "35", ",", "0"}], "]"}]}], "}"}]}], 
          "}"}]}]}], "*)"}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"All", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"All", ",", "All"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "0"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"BarLegend", "[", 
     RowBox[{"Automatic", ",", 
      RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}], ",", 
      RowBox[{"LegendMarkerSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"10", ",", 
         RowBox[{"1.04", "size"}]}], "}"}]}], ",", 
      RowBox[{"LegendMargins", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "15"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "0"}], "}"}]}], "}"}]}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"BarLegend", "[", 
      RowBox[{"Automatic", ",", 
       RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"10", ",", 
          RowBox[{"1.04", "size"}]}], "}"}]}], ",", 
       RowBox[{"LegendMargins", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "15"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "0"}], "}"}]}], "}"}]}]}], "]"}]}], ","}], 
   "*)"}]}]], "Input",ExpressionUUID->"56ab926c-e22f-4462-8011-7e86b3262d23"],

Cell[CellGroupData[{

Cell["Binary", "Subsection",
 CellChangeTimes->{{3.829712288577067*^9, 
  3.829712289286044*^9}},ExpressionUUID->"7a786fbd-35f8-4582-b3a7-\
249cb7b705c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DoubleQ", "[", "size_", "]"}], ":=", 
   RowBox[{"size", "\[Equal]", "8"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReadBinaryWFHeader", "[", "st_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "rep", ",", "unnorm", ",", "initsubtr", ",", "size", ",", 
       "ns", ",", "dxs", ",", "bounded"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dim", ",", "rep"}], "}"}], "=", 
       RowBox[{"BinaryReadList", "[", 
        RowBox[{"st", ",", " ", "\"\<UnsignedInteger8\>\"", ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"unnorm", ",", "initsubtr"}], "}"}], "=", 
       RowBox[{"BinaryReadList", "[", 
        RowBox[{"st", ",", " ", "\"\<Byte\>\"", ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"size", "=", 
       RowBox[{"First", "@", 
        RowBox[{"BinaryReadList", "[", 
         RowBox[{"st", ",", " ", "\"\<Integer32\>\"", ",", "1"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ns", "=", 
       RowBox[{"BinaryReadList", "[", 
        RowBox[{"st", ",", " ", "\"\<Integer64\>\"", ",", "dim"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dxs", "=", 
       RowBox[{"BinaryReadList", "[", 
        RowBox[{"st", ",", " ", "\"\<Real64\>\"", ",", "dim"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bounded", "=", 
       RowBox[{"BinaryReadList", "[", 
        RowBox[{"st", ",", " ", "\"\<Byte\>\"", ",", "dim"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dim", ",", "rep"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"unnorm", ",", "initsubtr"}], "}"}], ",", "size", ",", "ns", 
        ",", "dxs", ",", "bounded"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReadBinaryWF", "[", 
    RowBox[{"st_", ",", "dim_", ",", "n_", ",", "size_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"typesize", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DoubleQ", "[", "size", "]"}], ",", "\"\<Real64\>\"", ",", 
         "\"\<Complex128\>\""}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"BinaryReadList", "[", 
           RowBox[{"st", ",", " ", "typesize", ",", 
            RowBox[{"n", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ",", "##"}], "]"}], 
        "&"}], ",", 
       RowBox[{"Most", "[", "n", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportBinaryAndPlot", "[", 
    RowBox[{"file_", ",", 
     RowBox[{"collapse_", ":", "False"}], ",", 
     RowBox[{"scaleF_", ":", "Identity"}], ",", "opts___"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "rep", ",", "unnorm", ",", "initWfSubtr", ",", "size", ",", 
       "ns", ",", "dxs", ",", "lmaxs", ",", "st", ",", "\[IndentingNewLine]", 
       "norm", ",", "dat", ",", "base", ",", "opt", ",", "rng", ",", "vLabel",
        ",", "\[Psi]", ",", "dV", ",", "bounded"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"base", "=", 
       RowBox[{"FileNameTake", "[", "file", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "read", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"st", "=", 
       RowBox[{"OpenRead", "[", 
        RowBox[{"file", ",", 
         RowBox[{"BinaryFormat", "\[Rule]", "True"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"dim", ",", "rep"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"unnorm", ",", "initWfSubtr"}], "}"}], ",", "size", ",", 
         "ns", ",", "dxs", ",", "bounded"}], "}"}], "=", 
       RowBox[{"ReadBinaryWFHeader", "[", "st", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dim", ",", "rep"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"unnorm", ",", "initWfSubtr"}], "}"}], ",", "size", ",", 
            "ns", ",", "dxs", ",", "bounded"}], "}"}], ",", "\"\<ok\>\""}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"ReadBinaryWF", "[", 
        RowBox[{"st", ",", "dim", ",", "ns", ",", "size"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "file", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dim", ",", "rep"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"unnorm", ",", "initWfSubtr"}], "}"}], ",", "size", ",", 
            "ns", ",", "dxs", ",", "bounded"}], "}"}], ",", "\"\<data\>\""}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"make", " ", "range"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"lmaxs", "=", 
       RowBox[{"Times", "@@", 
        RowBox[{"{", 
         RowBox[{"dxs", " ", ",", 
          RowBox[{"(", 
           RowBox[{"ns", "-", "1"}], ")"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rng", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "lmaxs"}], "/", "2.0"}], ",", 
          RowBox[{"lmaxs", "/", "2.0"}]}], "}"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "label", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vLabel", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Latin Modern Roman\>\""}], 
           ",", "14"}], "]"}], "&"}], "/@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DoubleQ", "[", "size", "]"}], ",", 
          SuperscriptBox[
           RowBox[{
           "\[LeftBracketingBar]", "\[Psi]", "\[RightBracketingBar]"}], "2"], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Abs", "[", "\[Psi]", "]"}], ",", 
            RowBox[{"Arg", "[", "\[Psi]", "]"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"collapse", " ", "if", " ", "req"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"If", "[", 
        RowBox[{"collapse", ",", 
         RowBox[{
          RowBox[{"Abs", "[", "dat", "]"}], "^", "2"}], ",", "dat"}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"normalize", " ", "if", " ", "req"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"dV", "=", 
         RowBox[{"Times", "@@", "dxs"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"dat", ",", "\[Infinity]"}], "]"}], ",", 
          "\"\<\[LeftBracketingBar]dat\!\(\*SuperscriptBox[\(\
\[RightBracketingBar]\), \(2\)]\)\>\""}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{"dim", ",", "\"\<dim\>\""}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dV", "=", 
       RowBox[{"Times", "@@", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", " ", "/", 
            RowBox[{"(", 
             RowBox[{"#2", "^", "#3"}], ")"}]}], "&"}], ",", 
          RowBox[{"{", " ", 
           RowBox[{"dxs", ",", "ns", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"rep", "==", "1"}], ",", 
              RowBox[{"1", "-", "bounded"}], ",", "bounded"}], "]"}]}], 
           "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{"dV", ",", "\"\<dV\>\""}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{"dxs", ",", "ns", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"rep", "==", "1"}], ",", 
              RowBox[{"1", "-", "bounded"}], ",", "bounded"}], "]"}]}], "}"}],
           ",", "\"\<tablice\>\""}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"unnorm", "==", "1"}], ",", 
         RowBox[{"dat", "*", "dV"}], ",", "dat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"norm", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"dat", ",", "\[Infinity]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"dat", "=", 
         RowBox[{"RotateRight", "[", 
          RowBox[{"dat", ",", 
           RowBox[{"ns", "/", "2"}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{"base", ",", "\"\<base\>\""}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{"bounded", ",", "\"\<bounded\>\""}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"scaleF", "@", "dat"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"dim", ",", "\[IndentingNewLine]", "1", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DoubleQ", "[", "size", "]"}], "||", " ", "collapse"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Prob1D", "[", 
           RowBox[{"dat", ",", "rng", ",", "opts"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GRID", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Prob1D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "dat", "]"}], "^", "2"}], ",", "rng", 
                ",", "250", ",", 
                RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}], ",", 
              RowBox[{"Phase1D", "[", 
               RowBox[{
                RowBox[{"Arg", "@", "dat"}], ",", "rng", ",", "250", ",", 
                RowBox[{"FrameStyle", "\[Rule]", "Red"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], "}"}], 
            "}"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", "2", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DoubleQ", "[", "size", "]"}], "||", " ", "collapse"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Prob2D", "[", 
           RowBox[{"dat", ",", "rng", ",", "norm", ",", "opts"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GRID", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Prob2D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "dat", "]"}], "^", "2"}], ",", "rng", 
                ",", "250", ",", "True"}], "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Phase2D", "[", 
               RowBox[{
                RowBox[{"Arg", "@", "dat"}], ",", "rng", ",", "250"}], "]"}], 
              "}"}]}], "}"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", "3",
         ",", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"DoubleQ", "[", "size", "]"}], "||", " ", "collapse"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Prob3D", "[", 
           RowBox[{"dat", ",", "rng", ",", "norm", ",", "opts"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GRID", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Prob3D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "dat", "]"}], "^", "2"}], ",", "rng", 
                ",", "250"}], "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Phase3D", "[", 
               RowBox[{
                RowBox[{"Arg", "@", "dat"}], ",", "rng", ",", "250"}], "]"}], 
              "}"}]}], "}"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalcWFNorm", "[", 
    RowBox[{"file_", ",", 
     RowBox[{"collapse_", ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "rep", ",", "unnorm", ",", "initWfSubtr", ",", "size", ",", 
       "ns", ",", "dxs", ",", "lmaxs", ",", "st", ",", "\[IndentingNewLine]", 
       "norm", ",", "dat", ",", "base", ",", "opt", ",", "rng", ",", "vLabel",
        ",", "\[Psi]", ",", "dV", ",", "bounded"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "read", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"st", "=", 
       RowBox[{"OpenRead", "[", 
        RowBox[{"file", ",", 
         RowBox[{"BinaryFormat", "\[Rule]", "True"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"dim", ",", "rep"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"unnorm", ",", "initWfSubtr"}], "}"}], ",", "size", ",", 
         "ns", ",", "dxs", ",", "bounded"}], "}"}], "=", 
       RowBox[{"ReadBinaryWFHeader", "[", "st", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"ReadBinaryWF", "[", 
        RowBox[{"st", ",", "dim", ",", "ns", ",", "size"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "file", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"dat", "=", 
         RowBox[{"If", "[", 
          RowBox[{"collapse", ",", 
           RowBox[{
            RowBox[{"Abs", "[", "dat", "]"}], "^", "2"}], ",", "dat"}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "data"}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"dV", "=", 
       RowBox[{"Times", "@@", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", " ", "/", 
            RowBox[{"(", 
             RowBox[{"#2", "^", "#3"}], ")"}]}], "&"}], ",", 
          RowBox[{"{", " ", 
           RowBox[{"dxs", ",", "ns", ",", 
            RowBox[{"1", "-", "bounded"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"unnorm", "==", "1"}], ",", 
         RowBox[{"dat", "*", "dV"}], ",", "dat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"norm", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"dat", ",", "\[Infinity]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "norm"}], "*)"}], "\[IndentingNewLine]", "]"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[340]:=",ExpressionUUID->"37b93b60-b27c-45e1-9cb2-a936bebf0af9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nam", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<N\>\"", ",", "\"\<\!\(\*SubscriptBox[\(S\), \(X\)]\)\>\"", ",", " ", 
     "\"\<\!\(\*SubscriptBox[\(S\), \(Y\)]\)\>\"", ",", " ", 
     "\"\<\!\(\*SubscriptBox[\(S\), \(Z\)]\)\>\"", ",", " ", 
     "\"\<\!\(\*SubscriptBox[\(D\), \(XY\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(D\), \(XZ\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(D\), \(YZ\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(T\), \(XYZ\)]\)\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dir", "=", "\"\<template/Results/\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"RemoveComments", ":=", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", "#", "]"}], ",", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"StringTrim", "@", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"RegularExpression", "[", "\"\<#.*\>\"", "]"}], 
             "\[Rule]", "\"\<\>\""}]}], "]"}]}]}], ",", 
        RowBox[{"Identity", "[", "#", "]"}]}], "]"}], "&"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DisplayINI", ":=", 
     RowBox[{
      RowBox[{"Dataset", "@", 
       RowBox[{"Map", "[", 
        RowBox[{"RemoveComments", ",", 
         RowBox[{"Import", "[", 
          RowBox[{"First", "@", 
           RowBox[{"FileNames", "[", 
            RowBox[{"#", "<>", "\"\<../*.ini\>\""}], "]"}]}], "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}]}], "&"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dx", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"DisplayINI", "[", "dir", "]"}], "[", 
       RowBox[{"\"\<DEFAULT\>\"", ",", "\"\<L\>\""}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"DisplayINI", "[", "dir", "]"}], "[", 
         RowBox[{"\"\<DEFAULT\>\"", ",", "\"\<n\>\""}], "]"}], "-", "1"}], 
       ")"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Echo", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"N", "@", "2"}], 
       RowBox[{"\[Pi]", "/", 
        RowBox[{
         RowBox[{"DisplayINI", "[", "dir", "]"}], "[", 
         RowBox[{"\"\<DEFAULT\>\"", ",", "\"\<L\>\""}], "]"}]}]}], ",", 
      "dp"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"n", "=", 
     RowBox[{
      RowBox[{"DisplayINI", "[", "dir", "]"}], "[", 
      RowBox[{"\"\<DEFAULT\>\"", ",", "\"\<n\>\""}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Echo", "[", 
     RowBox[{
      RowBox[{"N", "@", "dx"}], ",", "\"\<dx\>\""}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Echo", "[", 
     RowBox[{"n", ",", "\"\<n\>\""}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Echo", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"N", "@", "\[Pi]"}], "/", "dx"}], ",", 
      SubscriptBox["p", "max"]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Id", ":=", 
   RowBox[{
    RowBox[{"ToExpression", "@", 
     RowBox[{"StringTake", "[", 
      RowBox[{"#", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"viewpoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cplot", ":=", 
   RowBox[{
    RowBox[{"ImportBinaryAndPlot", "[", 
     RowBox[{"#", ",", "True", ",", "Identity", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ClipPlanes", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "2"}], "}"}], "}"}]}], ",", 
        RowBox[{"OpacityFunction", "\[Rule]", "None"}], ","}], "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "->", "Full"}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"InterpolationOrder", "->", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ViewMatrix", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"s", ".", "rx", ".", "rz"}], "]"}], ",", "p"}], "}"}]}], 
        ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"viewpoints", "[", 
          RowBox[{"[", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Id", "@", "#"}], ">", "3"}], ",", "1", ",", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"Id", "@", "#"}], ",", "3", ",", "1"}], "]"}]}], "]"}],
            "]"}], "]"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ViewPoint", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Top", ",", "Left", ",", "Front"}], "}"}], "[", 
           RowBox[{"[", 
            RowBox[{"Id", "@", "#"}], "]"}], "]"}], ")"}]}], ","}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ViewVector", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2.9", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Id", "@", "#"}], ">", "3"}], ",", 
              RowBox[{"RotateRight", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "30", ",", "0"}], "}"}], ",", 
                RowBox[{"Id", "@", "#"}]}], "]"}], ",", 
              RowBox[{"RotateLeft", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"30", ",", "0.0", ",", "0.0"}], "}"}], ",", 
                RowBox[{"Id", "@", "#"}]}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0.0"}], "}"}]}], "}"}]}], ","}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"Z", ",", "Y", ",", "X"}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "->", 
       RowBox[{"nam", "[", 
        RowBox[{"[", 
         RowBox[{"1", "+", 
          RowBox[{"Id", "@", "#"}]}], "]"}], "]"}]}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"order", ":=", 
    RowBox[{
     RowBox[{"ToExpression", "@", 
      RowBox[{"StringExtract", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\"\<psib\>\"", "->", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"\"\<_\>\"", "->", "1"}]}], "]"}]}], "&"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"order", ":=", 
     RowBox[{
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringExtract", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\"\<_\>\"", "->", "1"}], ",", 
         RowBox[{"\"\<psib\>\"", "->", 
          RowBox[{"-", "1"}]}]}], "]"}]}], "&"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sorted", ":=", 
   RowBox[{
    RowBox[{"SplitBy", "[", 
     RowBox[{
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"FileNames", "[", 
         RowBox[{"dir", "<>", "#"}], "]"}], ",", "order"}], "]"}], ",", 
      "order"}], "]"}], "&"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[274]:=",ExpressionUUID->"419c0c2c-516b-43e5-aae0-eaacbef41cfd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sorted", "[", "\"\<during*.psib*\>\"", "]"}]], "Input",
 CellLabel->
  "In[265]:=",ExpressionUUID->"ccaf7f99-9126-4204-b0ea-29cc521f0cf5"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->
  "Out[265]=",ExpressionUUID->"fbfcc8bd-9c0f-4743-8c77-f154af9940b3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"data", "="}], "*)"}], 
  RowBox[{
  "CalcWFNorm", "[", "\"\<~/Downloads/sparse/ground.bin\>\"", 
   "]"}]}]], "Input",
 CellLabel->
  "In[345]:=",ExpressionUUID->"2aa90061-ca7e-43c8-80ff-0b57f58602a8"],

Cell[BoxData[
 RowBox[{"data", "[", 
  RowBox[{"[", 
   RowBox[{";;", ";;", "64"}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[317]:=",ExpressionUUID->"03f72b79-293e-4a0e-96f0-2184c4819c0c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{";;", ";;", "64"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"#", "!=", "0."}], "&"}]}], "]"}]], "Input",
 CellLabel->
  "In[310]:=",ExpressionUUID->"11eedbf3-b0c3-48c2-a4f8-9338a56fe450"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->
  "Out[310]=",ExpressionUUID->"97c43d47-08ff-43d9-9796-946497041293"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dir", "=", "\"\<nitrogen-3e/Results/\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"FileNames", "[", 
    RowBox[{"dir", "<>", "\"\<*\>\""}], "]"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{"sorted", "[", "\"\<during*.psib*\>\"", "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"Multicolumn", "[", 
     RowBox[{
      RowBox[{"cplot", "/@", "#"}], ",", "8"}], "]"}], "]"}], "&"}], "/@", 
  RowBox[{"sorted", "[", "\"\<during*.psib*\>\"", "]"}]}]}], "Input",
 CellLabel->
  "In[283]:=",ExpressionUUID->"1466ae9a-f41e-4cd4-867d-3dfb3c1c46ee"],

Cell["", "Text",ExpressionUUID->"c2bbd0fa-5f38-4b4e-b0f0-5891392737dd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null", 
   ",", "Null", ",", "Null"}], "}"}]], "Output",
 CellLabel->
  "Out[271]=",ExpressionUUID->"76c81307-4f2e-4e7b-8a08-a1dafd607c86"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "refresh", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sorted", ":=", 
     RowBox[{
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"FileNames", "[", 
           RowBox[{"dir", "<>", "#"}], "]"}], ",", "order"}], "]"}], ",", 
        "order"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "during", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"before", "=", 
     RowBox[{"sorted", "@", "\"\<RE3e3d*_bef_xyz.psib*\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"selected", "=", 
     RowBox[{"sorted", "@", "\"\<RE3e3d*_*i_xyz.psib*\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"after", "=", 
     RowBox[{"sorted", "@", "\"\<RE3e3d*_aft_xyz.psib*\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"selected", "=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"before", ",", "selected", ",", "after"}], "]"}], "[", 
     RowBox[{"[", "All", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"cplot", "/@", "#"}], ")"}], "&"}], "/@", "selected"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "]"}]}]}]], "Input",
 CellLabel->"In[27]:=",
 CellID->1812452921,ExpressionUUID->"009e8f5c-fca5-4f17-ad70-bd3262e7ee2f"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[31]=",ExpressionUUID->"5a6df384-638c-4e82-945c-4493b95fc231"],

Cell[BoxData[
 InterpretationBox[
  TagBox[GridBox[{
     {""}
    },
    AutoDelete->False,
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{"Columns" -> {{-1}}}],
   "Grid"],
  Grid[{}, Spacings -> -1]]], "Output",
 CellLabel->"Out[32]=",ExpressionUUID->"6f4d9d79-6f5b-4704-95b5-3ba2915c6bff"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"files", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"dir", "<>", "\"\</*.psi*\>\""}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[47]:=",ExpressionUUID->"28c02a53-9757-48dd-94cd-a69e94315411"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"st", "=", 
   RowBox[{"OpenRead", "[", 
    RowBox[{
     RowBox[{"First", "@", 
      RowBox[{"Select", "[", 
       RowBox[{"files", ",", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", "\"\<im\>\""}], "]"}], "&"}]}], "]"}]}], ",", 
     RowBox[{"BinaryFormat", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"dims", ",", "rep"}], "}"}], "=", 
  RowBox[{"BinaryReadList", "[", 
   RowBox[{"st", ",", " ", "\"\<UnsignedInteger8\>\"", ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"unnorm", ",", "initsubtr"}], "}"}], "=", 
  RowBox[{"BinaryReadList", "[", 
   RowBox[{"st", ",", " ", "\"\<Byte\>\"", ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"size", "=", 
  RowBox[{"BinaryRead", "[", 
   RowBox[{"st", ",", " ", "\"\<Integer32\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ns", "=", 
  RowBox[{"BinaryReadList", "[", 
   RowBox[{"st", ",", " ", "\"\<Integer64\>\"", ",", "dims"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxs", "=", 
   RowBox[{"BinaryReadList", "[", 
    RowBox[{"st", ",", " ", "\"\<Real64\>\"", ",", "dims"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"BinaryReadList", "[", 
    RowBox[{"st", ",", " ", "\"\<Complex128\>\"", ",", "10"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"typesize", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"DoubleQ", "[", "size", "]"}], ",", "\"\<Real64\>\"", ",", 
     "\"\<Complex128\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"data", "=", 
  RowBox[{"Abs", "@", 
   RowBox[{"Apply", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BinaryReadList", "[", 
         RowBox[{"st", ",", " ", "typesize", ",", 
          RowBox[{"ns", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ",", "##"}], "]"}], 
      "&"}], ",", 
     RowBox[{"Most", "[", "ns", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListDensityPlot3D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "#", "]"}], "^", "2"}], "&"}], "/@", "data"}], 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"cplot", "[", 
    RowBox[{
     RowBox[{"files", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "True"}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dim", ",", "rep", ",", "unnorm", ",", "initWfSubtr", ",", "size"}], 
        "}"}], ",", "ns", ",", "dxs"}], "}"}], "=", 
     RowBox[{"ReadBinaryWFHeader", "[", "st", "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Close", "[", "st", "]"}]}], "Input",
 CellLabel->
  "In[271]:=",ExpressionUUID->"63f520a6-8fe0-4b85-8ea2-b8fa863e9502"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "1"}], "}"}]], "Output",
 CellLabel->
  "Out[272]=",ExpressionUUID->"8dc061ac-61d6-49ac-bdc5-50c1c8805383"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0"}], "}"}]], "Output",
 CellLabel->
  "Out[273]=",ExpressionUUID->"66e4d070-41c8-4831-aea5-88c17c380070"],

Cell[BoxData["16"], "Output",
 CellLabel->
  "Out[274]=",ExpressionUUID->"9f65e875-d9f7-4a59-a07b-1ebee1163042"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"32", ",", "32", ",", "32"}], "}"}]], "Output",
 CellLabel->
  "Out[275]=",ExpressionUUID->"046de108-7246-4b38-acef-218c844e4fc0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.5`", ",", "1.5`", ",", "1.5`"}], "}"}]], "Output",
 CellLabel->
  "Out[276]=",ExpressionUUID->"e8b2bd28-79c3-4857-b566-24256ed81d22"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dir", "=", "\"\<template/Results/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"dir", "<>", "\"\</*.psi*\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati0_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati1_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati50_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati150_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati200_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<ati1000_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", 
    RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<im\>\""}], "]"}], "&"}]}], "]"}]}]}], "Input",Exp\
ressionUUID->"12e8e1d4-6311-42e3-8d06-9e766a03fd87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dir", "=", "\"\<nitrogen-3e/Results/\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dir", "=", "\"\<~/Downloads/\>\""}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dir", "=", "\"\<nitrogen-3e/512/\>\""}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"dir", "<>", "\"\</*.psi*\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"log", ":=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Log", "[", "#", "]"}]}], "&"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"cplot", "[", 
      RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"files", ",", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<final_ionized_joined_P_\>\""}], "]"}], "&"}]}],
      "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"files", ",", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<final_joined_P_\>\""}], "]"}], "&"}]}], 
     "]"}]}], "*)"}]}]}], "Input",
 CellLabel->"In[59]:=",ExpressionUUID->"9c1d306a-9bdf-47a6-9556-eab3d239cab4"],

Cell["\<\
F=0.22 ? not sure were Dmitry finished for Nitrogen
0.12 trusted.\
\>", "Text",ExpressionUUID->"5d30fd53-b166-448c-ab33-65fb59dae4ba"],

Cell[BoxData["files"], "Input",ExpressionUUID->"458b7fa3-8c8a-4895-8b7e-995c97be671b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<im\>\""}], "]"}], "&"}]}], "]"}]}]], "Input",
 CellLabel->"In[86]:=",ExpressionUUID->"131e4137-03c4-481b-82c0-ca589cb29d2d"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Input",
 CellChangeTimes->{{3.838142313582941*^9, 
  3.83814231361395*^9}},ExpressionUUID->"4875a304-b19d-4eca-8014-\
117a4379d8ff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"Accumulate", "@", 
     RowBox[{"IpAtomic", "[", 
      RowBox[{"\"\<Neon\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ",", 
    "\"\<Neon Ip's\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"Accumulate", "@", 
     RowBox[{"IpAtomic", "[", 
      RowBox[{"\"\<Nitrogen\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ",", 
    "\"\<Nitrogen Ip's (Mathematica says so)\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"Accumulate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"UnitConvert", "[", 
        RowBox[{
         RowBox[{"Quantity", "[", 
          RowBox[{"#", ",", "\"\<eV\>\""}], "]"}], ",", 
         "\"\<HartreeEnergy\>\""}], "]"}], "&"}], "/@", " ", 
      RowBox[{"{", 
       RowBox[{"14.53414", " ", ",", "29.6013", ",", " ", "47.44924"}], 
       "}"}]}], "]"}], ",", "\"\<Nitrogen Ip's (online source)\>\""}], "]"}], 
  ";"}]}], "Input",
 CellLabel->
  "In[367]:=",ExpressionUUID->"b2bb59e5-4799-478e-9b29-006515541555"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Neon Ip's\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "0.7924967761230405677`4.999999834968128", ",", 
    "2.297848344475562909`4.999999834968128", ",", 
    "4.6295949986906128227`4.25704327137838"}], "}"}]}]], "Echo",ExpressionUUI\
D->"329556a6-1e24-4860-9319-b21c69c701db"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nitrogen Ip's (Mathematica says so)\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "0.5341078623335126583`4.999999834968128", ",", 
    "1.6219008130748035034`4.152661082941877", ",", 
    "3.3656070132809322211`4.407947962095298"}], "}"}]}]], "Echo",ExpressionUU\
ID->"70c5970b-c384-4810-bc41-1f5d8ddefb5c"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nitrogen Ip's (online source)\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    TemplateBox[{"0.5341197934060651`", 
      SubscriptBox[
       StyleBox["\"E\"", Italic, StripOnInput -> False], "\"h\""], 
      "Hartree energies", "\"HartreeEnergy\""},
     "Quantity"], ",", 
    TemplateBox[{"1.6219475039242623`", 
      SubscriptBox[
       StyleBox["\"E\"", Italic, StripOnInput -> False], "\"h\""], 
      "Hartree energies", "\"HartreeEnergy\""},
     "Quantity"], ",", 
    TemplateBox[{"3.3656749116742084`", 
      SubscriptBox[
       StyleBox["\"E\"", Italic, StripOnInput -> False], "\"h\""], 
      "Hartree energies", "\"HartreeEnergy\""},
     "Quantity"]}], "}"}]}]], "Echo",ExpressionUUID->"5fd10f81-ba23-4546-8cc6-\
dcf63e8befca"]
}, Open  ]]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dir", "=", "\"\<nitrogen-3e/Results/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"dir", "<>", "\"\</*.psi*\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<at0_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<at1_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<at50_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<at100_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<at150_\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"Select", "[", 
    RowBox[{"files", ",", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{"#", ",", "\"\<at200_\>\""}], "]"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"files", ",", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<at250_\>\""}], "]"}], "&"}]}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"Select", "[", 
    RowBox[{"files", ",", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{"#", ",", "\"\<at300_\>\""}], "]"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"files", ",", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<at350_\>\""}], "]"}], "&"}]}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<final_0\>\""}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cplot", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"Select", "[", 
   RowBox[{"files", ",", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"#", ",", "\"\<final_joined_P_\>\""}], "]"}], "&"}]}], 
   "]"}]}]}], "Input",
 CellLabel->
  "In[423]:=",ExpressionUUID->"21f81ee8-e107-4538-9271-f04a705c31ed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StrongFieldUtils`IpAtomic", "[", 
  RowBox[{"\"\<Nitrogen\>\"", ",", "3"}], "]"}]], "Input",
 CellLabel->
  "In[295]:=",ExpressionUUID->"25bec77a-b512-4f0c-9545-5746a7578c1f"],

Cell[BoxData["1.7437062002061287177`4.999999834968128"], "Output",
 CellLabel->
  "Out[295]=",ExpressionUUID->"6a260ed2-fa58-424d-b796-93cde9d1b18e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"cplot", "[", "#", "]"}], "]"}], "&"}], "/@", "%"}]], "Input",
 CellLabel->
  "In[186]:=",ExpressionUUID->"1deb7aef-9dea-4857-9518-8ab9582b9e62"],

Cell[BoxData[
 RowBox[{"{", "Null", "}"}]], "Output",
 CellLabel->
  "Out[186]=",ExpressionUUID->"27fbc24e-f08f-4a84-9ab0-92f62fca3690"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib1\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib2\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib3\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib4\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib5\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib6\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cplot", "[", 
  "\"\</Users/ranza/Downloads/at1_0ELECeDIMd__aft_xyz.psib7\>\"", 
  "]"}]}], "Input",ExpressionUUID->"3232165b-aa2e-4854-b00d-5c0e40ebd4c4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<at1_\>\""}], "]"}], "&"}]}], "]"}]}], ")"}],
      ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<at50_\>\""}], "]"}], "&"}]}], "]"}]}], 
      ")"}], ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<at100_\>\""}], "]"}], "&"}]}], "]"}]}], 
      ")"}], ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<at150_\>\""}], "]"}], "&"}]}], "]"}]}], 
      ")"}], ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<at200_\>\""}], "]"}], "&"}]}], "]"}]}], 
      ")"}], ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CalcWFNorm", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<final\>\""}], "]"}], "&"}]}], "]"}]}], 
      ")"}], ")"}], ",", "\"\<Nowa wersja\>\""}], "]"}], ";"}]}], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"fbb28ead-b819-44da-b59a-6b41088be28f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "0.9999999997444639`", ",", "7.384716886400857`*^-11", ",", 
    "7.384716886407496`*^-11", ",", "7.384716886409811`*^-11", ",", 
    "1.0925905394229457`*^-14", ",", "1.0925905394216863`*^-14", ",", 
    "1.5775653229828753`*^-14", ",", "7.384263048730993`*^-25"}], 
   "}"}]}]], "Echo",ExpressionUUID->"e0d8a200-22a6-4a9b-9ec9-ef19e2d191c9"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "6.791237320407708`*^-11", ",", "4.455200825722581`*^-7", ",", 
    "4.45520082572257`*^-7", ",", "4.4552008257226405`*^-7", ",", 
    "0.0011067344479767666`", ",", "0.0011067344479767669`", ",", 
    "0.0007939710627467297`", ",", "1.0427908974409374`"}], "}"}]}]], "Echo",E\
xpressionUUID->"f7a80985-f776-486b-a5d6-70c29ef5b1d4"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "0.522255609013465`", ",", "0.13149073672585027`", ",", 
    "0.13149073672585032`", ",", "0.1314907367258503`", ",", 
    "0.014190168131023407`", ",", "0.014190168131023409`", ",", 
    "0.01419016813102341`", ",", "0.00170842670807647`"}], "}"}]}]], "Echo",Ex\
pressionUUID->"546f37b8-7b7a-413f-81a9-ac044ee08bdb"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "0.012925085733704652`", ",", "0.0511923415202839`", ",", 
    "0.051192341520283915`", ",", "0.051192341520283874`", ",", 
    "0.03381785455120159`", ",", "0.03381785455120148`", ",", 
    "0.03381785455120153`", ",", "0.03517340769856293`"}], "}"}]}]], "Echo",Ex\
pressionUUID->"e4c94ef5-6f2b-4e39-8a80-ca78aa9c8ad1"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "0.00013784611557035264`", ",", "0.001063264569461637`", ",", 
    "0.0010632645694616386`", ",", "0.0010632645694616382`", ",", 
    "0.006777063370829729`", ",", "0.006777063370829749`", ",", 
    "0.006777063370829736`", ",", "0.14232089653921048`"}], "}"}]}]], "Echo",E\
xpressionUUID->"2ed4f811-7dea-4673-bb8b-77a80660bfd2"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Nowa wersja\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
   "5.753862022456611`*^-8", ",", "5.983781622371874`*^-6", ",", 
    "5.983781622371908`*^-6", ",", "5.983781622371918`*^-6", ",", 
    "0.00033338471536406913`", ",", "0.0003333847153640686`", ",", 
    "0.00033338471536406913`", ",", "0.15347819615227654`"}], "}"}]}]], "Echo",\
ExpressionUUID->"ce49d6cc-6447-4b9b-bcbb-823f22159ec3"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nam", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<N\>\"", ",", "\"\<\!\(\*SubscriptBox[\(S\), \(X\)]\)\>\"", ",", " ", 
     "\"\<\!\(\*SubscriptBox[\(S\), \(Y\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(D\), \(XY\)]\)\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cplot", ":=", 
   RowBox[{
    RowBox[{"ImportBinaryAndPlot", "[", 
     RowBox[{"#", ",", "False", ",", "Identity", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ClipPlanes", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "2"}], "}"}], "}"}]}], ",", 
        RowBox[{"OpacityFunction", "\[Rule]", "None"}], ","}], "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "->", "Full"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"PlotLegends", "->", "Automatic"}], ","}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", 
        RowBox[{"Y", ",", "X"}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "->", 
       RowBox[{"nam", "[", 
        RowBox[{"[", 
         RowBox[{"1", "+", 
          RowBox[{"ToExpression", "@", 
           RowBox[{"StringTake", "[", 
            RowBox[{"#", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], "]"}]}]}], "]"}], 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", ":=", 
   RowBox[{
    RowBox[{"ToExpression", "@", 
     RowBox[{"StringExtract", "[", 
      RowBox[{"#", ",", 
       RowBox[{"\"\<_\>\"", "->", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"\"\<i\>\"", "->", "1"}]}], "]"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sorted", ":=", 
    RowBox[{
     RowBox[{"SplitBy", "[", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"dir", "<>", "#"}], "]"}], ",", "order"}], "]"}], ",", 
       "order"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "refresh", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"before", "=", 
   RowBox[{"sorted", "@", "\"\<RE2e2d*_bef_xy.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selected", "=", 
   RowBox[{"sorted", "@", "\"\<RE2e2d*_*i_xy.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"after", "=", 
   RowBox[{"sorted", "@", "\"\<RE2e2d*_aft_xy.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selected", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"before", ",", "selected", ",", "after"}], "]"}], "[", 
    RowBox[{"[", "All", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"cplot", "/@", "#"}], ")"}], "&"}], "/@", "selected"}], ",", 
   RowBox[{"Spacings", "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "]"}]}], "Input",ExpressionUUID->"36fd4a1b-4d2b-\
4da4-b502-2b3cdf8c9a90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nam", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<N\>\"", ",", "\"\<\!\(\*SubscriptBox[\(S\), \(X\)]\)\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cplot", ":=", 
   RowBox[{
    RowBox[{"ImportBinaryAndPlot", "[", 
     RowBox[{"#", ",", "False", ",", "Identity", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ClipPlanes", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "2"}], "}"}], "}"}]}], ",", 
        RowBox[{"OpacityFunction", "\[Rule]", "None"}], ","}], "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "->", "Full"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"PlotLegends", "->", "Automatic"}], ","}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", "X", "}"}]}], ",", 
      RowBox[{"PlotLabel", "->", 
       RowBox[{"nam", "[", 
        RowBox[{"[", 
         RowBox[{"1", "+", 
          RowBox[{"ToExpression", "@", 
           RowBox[{"StringTake", "[", 
            RowBox[{"#", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], "]"}]}]}], "]"}], 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", ":=", 
   RowBox[{
    RowBox[{"ToExpression", "@", 
     RowBox[{"StringExtract", "[", 
      RowBox[{"#", ",", 
       RowBox[{"\"\<_\>\"", "->", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"\"\<i\>\"", "->", "1"}]}], "]"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sorted", ":=", 
    RowBox[{
     RowBox[{"SplitBy", "[", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"dir", "<>", "#"}], "]"}], ",", "order"}], "]"}], ",", 
       "order"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "refresh", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"before", "=", 
   RowBox[{"sorted", "@", "\"\<RE1e1d*_bef_x.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selected", "=", 
   RowBox[{"sorted", "@", "\"\<RE1e1d*_*i_x.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"after", "=", 
   RowBox[{"sorted", "@", "\"\<RE1e1d*_aft_x.psib*\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selected", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"before", ",", "selected", ",", "after"}], "]"}], "[", 
    RowBox[{"[", "All", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"cplot", "/@", "#"}], ")"}], "&"}], "/@", "selected"}], ",", 
   RowBox[{"Spacings", "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "]"}]}], "Input",ExpressionUUID->"93f602db-65ee-\
4f44-9cf0-219cef12c42e"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, 
  WindowMargins -> {{Automatic, 0}, {0, Automatic}}, Visible -> False, 
  FrontEndVersion -> "12.3 for Mac OS X x86 (64-bit) (May 11, 2021)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"1b012cc0-25e2-49f4-8daf-e1166430be28"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 273, 6, 46, "Input",ExpressionUUID->"a0881841-6297-42bf-b15a-dc9b1006819b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[856, 30, 82, 0, 67, "Section",ExpressionUUID->"016bd226-2cf2-4b93-9745-0d1876fcdb46"],
Cell[941, 32, 3199, 100, 290, "Input",ExpressionUUID->"810dc8be-1b79-4ad0-bc77-be8bac84b404",
 InitializationCell->True],
Cell[4143, 134, 8132, 211, 501, "Input",ExpressionUUID->"39a6eb59-13c4-4f58-93af-1349ad615d52",
 InitializationCell->True],
Cell[12278, 347, 3372, 92, 178, "Input",ExpressionUUID->"56ab926c-e22f-4462-8011-7e86b3262d23"],
Cell[CellGroupData[{
Cell[15675, 443, 154, 3, 54, "Subsection",ExpressionUUID->"7a786fbd-35f8-4582-b3a7-249cb7b705c9"],
Cell[15832, 448, 15965, 417, 1587, "Input",ExpressionUUID->"37b93b60-b27c-45e1-9cb2-a936bebf0af9",
 InitializationCell->True],
Cell[31800, 867, 7873, 229, 492, "Input",ExpressionUUID->"419c0c2c-516b-43e5-aae0-eaacbef41cfd",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[39698, 1100, 162, 3, 30, "Input",ExpressionUUID->"ccaf7f99-9126-4204-b0ea-29cc521f0cf5"],
Cell[39863, 1105, 128, 3, 34, "Output",ExpressionUUID->"fbfcc8bd-9c0f-4743-8c77-f154af9940b3"]
}, Open  ]],
Cell[40006, 1111, 254, 8, 30, "Input",ExpressionUUID->"2aa90061-ca7e-43c8-80ff-0b57f58602a8"],
Cell[40263, 1121, 190, 5, 30, "Input",ExpressionUUID->"03f72b79-293e-4a0e-96f0-2184c4819c0c"],
Cell[CellGroupData[{
Cell[40478, 1130, 297, 9, 30, "Input",ExpressionUUID->"11eedbf3-b0c3-48c2-a4f8-9338a56fe450"],
Cell[40778, 1141, 128, 3, 34, "Output",ExpressionUUID->"97c43d47-08ff-43d9-9796-946497041293"]
}, Open  ]],
Cell[40921, 1147, 691, 20, 94, "Input",ExpressionUUID->"1466ae9a-f41e-4cd4-867d-3dfb3c1c46ee"],
Cell[41615, 1169, 71, 0, 35, "Text",ExpressionUUID->"c2bbd0fa-5f38-4b4e-b0f0-5891392737dd"],
Cell[41689, 1171, 247, 6, 34, "Output",ExpressionUUID->"76c81307-4f2e-4e7b-8a08-a1dafd607c86"],
Cell[CellGroupData[{
Cell[41961, 1181, 1460, 41, 178, "Input",ExpressionUUID->"009e8f5c-fca5-4f17-ad70-bd3262e7ee2f",
 CellID->1812452921],
Cell[43424, 1224, 124, 2, 34, "Output",ExpressionUUID->"5a6df384-638c-4e82-945c-4493b95fc231"],
Cell[43551, 1228, 344, 10, 34, "Output",ExpressionUUID->"6f4d9d79-6f5b-4704-95b5-3ba2915c6bff"]
}, Open  ]],
Cell[43910, 1241, 229, 5, 30, "Input",ExpressionUUID->"28c02a53-9757-48dd-94cd-a69e94315411"],
Cell[CellGroupData[{
Cell[44164, 1250, 2966, 88, 283, "Input",ExpressionUUID->"63f520a6-8fe0-4b85-8ea2-b8fa863e9502"],
Cell[47133, 1340, 156, 4, 34, "Output",ExpressionUUID->"8dc061ac-61d6-49ac-bdc5-50c1c8805383"],
Cell[47292, 1346, 156, 4, 34, "Output",ExpressionUUID->"66e4d070-41c8-4831-aea5-88c17c380070"],
Cell[47451, 1352, 112, 2, 34, "Output",ExpressionUUID->"9f65e875-d9f7-4a59-a07b-1ebee1163042"],
Cell[47566, 1356, 169, 4, 34, "Output",ExpressionUUID->"046de108-7246-4b38-acef-218c844e4fc0"],
Cell[47738, 1362, 175, 4, 34, "Output",ExpressionUUID->"e8b2bd28-79c3-4857-b566-24256ed81d22"]
}, Open  ]],
Cell[47928, 1369, 2403, 78, 199, "Input",ExpressionUUID->"12e8e1d4-6311-42e3-8d06-9e766a03fd87"],
Cell[50334, 1449, 1453, 46, 157, "Input",ExpressionUUID->"9c1d306a-9bdf-47a6-9556-eab3d239cab4"],
Cell[51790, 1497, 144, 3, 58, "Text",ExpressionUUID->"5d30fd53-b166-448c-ab33-65fb59dae4ba"],
Cell[51937, 1502, 86, 0, 30, "Input",ExpressionUUID->"458b7fa3-8c8a-4895-8b7e-995c97be671b"],
Cell[52026, 1504, 342, 9, 30, "Input",ExpressionUUID->"131e4137-03c4-481b-82c0-ca589cb29d2d"],
Cell[52371, 1515, 169, 4, 30, "Input",ExpressionUUID->"4875a304-b19d-4eca-8014-117a4379d8ff"],
Cell[CellGroupData[{
Cell[52565, 1523, 1232, 36, 73, "Input",ExpressionUUID->"b2bb59e5-4799-478e-9b29-006515541555"],
Cell[CellGroupData[{
Cell[53822, 1563, 332, 9, 25, "Echo",ExpressionUUID->"329556a6-1e24-4860-9319-b21c69c701db"],
Cell[54157, 1574, 360, 9, 25, "Echo",ExpressionUUID->"70c5970b-c384-4810-bc41-1f5d8ddefb5c"],
Cell[54520, 1585, 799, 21, 29, "Echo",ExpressionUUID->"5fd10f81-ba23-4546-8cc6-dcf63e8befca"]
}, Open  ]]
}, Closed]],
Cell[55346, 1610, 3455, 113, 279, "Input",ExpressionUUID->"21f81ee8-e107-4538-9271-f04a705c31ed"],
Cell[CellGroupData[{
Cell[58826, 1727, 199, 4, 30, "Input",ExpressionUUID->"25bec77a-b512-4f0c-9545-5746a7578c1f"],
Cell[59028, 1733, 149, 2, 34, "Output",ExpressionUUID->"6a260ed2-fa58-424d-b796-93cde9d1b18e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59214, 1740, 218, 6, 30, "Input",ExpressionUUID->"1deb7aef-9dea-4857-9518-8ab9582b9e62"],
Cell[59435, 1748, 136, 3, 34, "Output",ExpressionUUID->"27fbc24e-f08f-4a84-9ab0-92f62fca3690"]
}, Open  ]],
Cell[59586, 1754, 924, 21, 157, "Input",ExpressionUUID->"3232165b-aa2e-4854-b00d-5c0e40ebd4c4"],
Cell[CellGroupData[{
Cell[60535, 1779, 3054, 96, 136, "Input",ExpressionUUID->"fbb28ead-b819-44da-b59a-6b41088be28f"],
Cell[CellGroupData[{
Cell[63614, 1879, 454, 10, 27, "Echo",ExpressionUUID->"e0d8a200-22a6-4a9b-9ec9-ef19e2d191c9"],
Cell[64071, 1891, 443, 10, 27, "Echo",ExpressionUUID->"f7a80985-f776-486b-a5d6-70c29ef5b1d4"],
Cell[64517, 1903, 428, 10, 25, "Echo",ExpressionUUID->"546f37b8-7b7a-413f-81a9-ac044ee08bdb"],
Cell[64948, 1915, 431, 10, 25, "Echo",ExpressionUUID->"e4c94ef5-6f2b-4e39-8a80-ca78aa9c8ad1"],
Cell[65382, 1927, 440, 10, 25, "Echo",ExpressionUUID->"2ed4f811-7dea-4673-bb8b-77a80660bfd2"],
Cell[65825, 1939, 445, 10, 27, "Echo",ExpressionUUID->"ce49d6cc-6447-4b9b-bcbb-823f22159ec3"]
}, Open  ]]
}, Open  ]],
Cell[66297, 1953, 3056, 89, 262, "Input",ExpressionUUID->"36fd4a1b-4d2b-4da4-b502-2b3cdf8c9a90"],
Cell[69356, 2044, 2901, 85, 268, "Input",ExpressionUUID->"93f602db-65ee-4f44-9cf0-219cef12c42e"]
}, Open  ]]
}, Open  ]]
}
]
*)

